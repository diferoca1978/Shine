---
import MainLayout from "@/layouts/MainLayout.astro";
import {
    generateBreadcrumbSchema,
    generateBlogPostSchema,
    type JSONLDSchema,
} from "@/config/seo";

interface Props {
    title: string;
    description: string;
    publishDate: Date;
    image?: string;
    slug: string;
}

const { title, description, publishDate, image, slug } = Astro.props;

// Sanitize slug: trim whitespace and ensure it's URL-safe
const sanitizedSlug = slug.trim().replace(/\s+/g, '-').toLowerCase();

// Generate specific schemas for the post
const postSchema = generateBlogPostSchema({
    title,
    description,
    publishDate,
    image,
    id: sanitizedSlug,
});

const breadcrumbSchema = generateBreadcrumbSchema([
    { name: "Inicio", url: "/" },
    { name: "Blog", url: "/blog" },
    { name: title, url: `/blog/${sanitizedSlug}` },
]);

const aditionalSchemas: JSONLDSchema[] = [postSchema, breadcrumbSchema];
---

<MainLayout
    title={title}
    description={description}
    path={`/blog/${sanitizedSlug}`}
    image={image}
    aditionalSchemas={aditionalSchemas}
>
    <slot />
</MainLayout>
