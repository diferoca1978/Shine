---
import { twMerge } from "tailwind-merge";

export interface Props {
  type?: "button" | "submit" | "reset";
  href?: string;
  rel?: string;
  target?: "_self" | "_blank" | "_parent" | "_top";
  variant?: "primary" | "secondary" | "tertiary" | "optional1" | "optional2";
  className?: string;
  id?: string;
  animation?: boolean;
}

const { type, href, rel, target, variant, className, id, animation } =
  Astro.props;
/**
 * Variants: Defines predefined styling options for the 'variant' prop.
 * - primary: Gradient button from deepplum to lavender with white text and hover effects.
 * - secondary: Bordered button with deepplum accents and hover effects.
 * - tertiary: Subtle salviaGreen button with transparent background and hover effects.
 */

const variants = {
  primary:
    "flex items-center justify-center gap-2 text-smokyBlack font-medium font-poppins bg-softBeige border border-salviaGreen hover:shadow-md hover:shadow-accentGreen/60 hover:scale-105 hover:bg-salviaGreen hover:text-softWhite transform transition-all ease-in-out duration-500",
  secondary:
    "flex items-center justify-center gap-2 text-deepplum font-semibold font-poppins bg-softWhite border-2 border-salviaGreen hover:shadow-md hover:shadow-accentGreen/60 hover:scale-105 hover:bg-accentGold hover:text-deepplum transform transition-all ease-in-out duration-500",
  tertiary:
    "flex items-center font-open-sans text-deepplum font-semibold font-poppins bg-softWhite border-2 border-deepplum hover:shadow-md hover:shadow-deepplum/60 hover:scale-105 hover:bg-sandRose hover:text-softWhite hover:border-softWhite transform transition-all ease-in-out duration-500",
  optional1:
    "flex items-center justify-center gap-2 px-6 py-3 bg-accentGold text-smokyBlack font-poppins font-semibold rounded-full hover:bg-accentGold/90 hover:border-smokyBlack hover:border transition-all duration-300 hover:gap-3",
  optional2: 
    "flex items-center justify-center text-smokyBlack font-medium font-poppins bg-softWhite border border-smokyBlack"
};
---

{
  /*
Button Component:
This component dynamically renders either a `<button>` element or an `<a>` (link) element based on the provided `href` prop.

- If the `href` prop is provided, an `<a>` tag is rendered to allow navigation.
- If no `href` is provided, a `<button>` tag is rendered for performing actions and supports the `type` attribute (e.g., 'button', 'submit', or 'reset') to specify its behavior.

Both types of elements share a similar structure and styling logic, with customization through the `variant`, `className`, and `id` props.
*/
}

{
  href ? (
    <a
      id={id}
      href={href}
      rel={rel ? rel : undefined}
      target={target ? target : undefined}
      class={twMerge(
        `rounded-3xl px-4 py-2 text-center focus:outline-hidden ${variants[variant ?? "primary"]} ${animation ? "star-animate" : ""} ${className || ""}`,
      )}
    >
      <slot />
    </a>
  ) : (
    <button
      id={id}
      type={type || "button"}
      class={twMerge(
        `rounded-3xl px-4 py-2 text-center focus:outline-hidden ${variants[variant ?? "primary"]} ${animation ? "star-animate" : ""} ${className || ""}`,
      )}
    >
      <slot />
    </button>
  )
}

{animation && (
  <script>
    import { gsap } from "gsap";

    document.addEventListener("DOMContentLoaded", () => {
      const animatedButtons = document.querySelectorAll(".star-animate");

      animatedButtons.forEach((button) => {
        const stars = button.querySelectorAll(".star, svg, img");

        if (stars.length > 0) {
          button.addEventListener("mouseenter", () => {
            gsap.to(stars, {
              rotation: 360,
              scale: 1.1,
              duration: 0.6,
              ease: "power2.out",
              transformOrigin: "center center"
            });
          });

          button.addEventListener("mouseleave", () => {
            gsap.to(stars, {
              rotation: 0,
              scale: 1,
              duration: 0.3,
              ease: "power2.out",
              transformOrigin: "center center"
            });
          });
        }
      });
    });
  </script>
)}

<style>
  /* Ensure star elements are properly displayed for animation */
  .star-animate .star,
  .star-animate svg,
  .star-animate img {
    display: inline-block;
  }
</style>
