---
// Theme toggle component - switches between light and dark mode
---

<button
  type="button"
  aria-label="Toggle dark mode"
  class="theme-toggle-btn p-2 rounded-full hover:scale-110 dark:hover:scale-110 transition-all duration-200"
  onclick="window.toggleTheme?.()"
>
  <!-- Sun Icon (visible in dark mode) -->
  <svg
    class="sun-icon hidden dark:block w-6 h-6 text-yellow-500"
    fill="none"
    stroke="currentColor"
    viewBox="0 0 24 24"
    xmlns="http://www.w3.org/2000/svg"
  >
    <path
      stroke-linecap="round"
      stroke-linejoin="round"
      stroke-width="2"
      d="M12 3v1m0 16v1m9-9h-1M4 12H3m15.364 6.364l-.707-.707M6.343 6.343l-.707-.707m12.728 0l-.707.707M6.343 17.657l-.707.707M16 12a4 4 0 11-8 0 4 4 0 018 0z"
    ></path>
  </svg>

  <!-- Moon Icon (visible in light mode) -->
  <svg
    class="moon-icon block dark:hidden w-6 h-6 text-smokyBlack"
    xmlns="http://www.w3.org/2000/svg"
    viewBox="0 0 24 24"
  >
    <path
      fill="#2f2f2f"
      d="m17.75 4.09l-2.53 1.94l.91 3.06l-2.63-1.81l-2.63 1.81l.91-3.06l-2.53-1.94L12.44 4l1.06-3l1.06 3zm3.5 6.91l-1.64 1.25l.59 1.98l-1.7-1.17l-1.7 1.17l.59-1.98L15.75 11l2.06-.05L18.5 9l.69 1.95zm-2.28 4.95c.83-.08 1.72 1.1 1.19 1.85c-.32.45-.66.87-1.08 1.27C15.17 23 8.84 23 4.94 19.07c-3.91-3.9-3.91-10.24 0-14.14c.4-.4.82-.76 1.27-1.08c.75-.53 1.93.36 1.85 1.19c-.27 2.86.69 5.83 2.89 8.02a9.96 9.96 0 0 0 8.02 2.89m-1.64 2.02a12.08 12.08 0 0 1-7.8-3.47c-2.17-2.19-3.33-5-3.49-7.82c-2.81 3.14-2.7 7.96.31 10.98c3.02 3.01 7.84 3.12 10.98.31"
      stroke-width="0.2"
      stroke="#2f2f2f"></path>
  </svg>
</button>

<script is:inline>
  // Make toggle function globally available
  window.toggleTheme = function() {
    const isDark = document.documentElement.classList.contains("dark");
    const newTheme = isDark ? "light" : "dark";

    if (isDark) {
      document.documentElement.classList.remove("dark");
      localStorage.theme = "light";
    } else {
      document.documentElement.classList.add("dark");
      localStorage.theme = "dark";
    }

    // Dispatch custom event for theme-aware animations
    window.dispatchEvent(new CustomEvent("themechange", { detail: { theme: newTheme } }));
  };

  // Initialize theme toggles with event delegation
  function initThemeToggles() {
    document.querySelectorAll(".theme-toggle-btn").forEach((btn) => {
      // Remove inline onclick to prevent double-firing
      btn.removeAttribute("onclick");
      // Add event listener
      btn.addEventListener("click", window.toggleTheme);
    });
  }

  // Initialize on DOM ready
  if (document.readyState === "loading") {
    document.addEventListener("DOMContentLoaded", initThemeToggles);
  } else {
    initThemeToggles();
  }

  // Re-initialize after Astro view transitions
  document.addEventListener("astro:page-load", initThemeToggles);
</script>
